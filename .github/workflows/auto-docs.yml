name: Auto-generate Documentation

# This workflow automatically generates documentation for the codebase
# It runs when PRs are merged (or via manual dispatch)
# The workflow uses an LLM to analyze code and create documentation

on:
  pull_request:
    types: [closed]
  workflow_dispatch:
    inputs:
      pr_number:
        description: 'Pull request number to document'
        required: false
        default: ''

permissions:
  contents: read
  pull-requests: write

jobs:
  docs:
    if: ${{ github.event.pull_request.merged == true || github.event_name == 'workflow_dispatch' }}
    # Uses a reusable workflow from the organization's .github repository
    # This centralizes the documentation generation logic for consistency across repos
    uses: wisdom-in-a-nutshell/.github/.github/workflows/generate-docs.yml@main

    with:
      # Specifies the runner environment for the documentation generation
      run-on: ubuntu-latest
      pr_number: ${{ github.event.pull_request.number || github.event.inputs.pr_number }}

    secrets:
      # API key for the Language Learning Model service used for documentation generation
      LLM_API_KEY: ${{ secrets.LLM_API_KEY }}

      # Endpoint URL for the LLM API service
      LLM_API_ENDPOINT: ${{ secrets.LLM_API_ENDPOINT }}
